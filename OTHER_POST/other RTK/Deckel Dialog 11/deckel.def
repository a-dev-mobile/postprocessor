#################################################################
# Post for DECKEL DIALOG 11
# Generated by Javier Garcia - UG * 23-Apr-2007
#################################################################

MACHINE GENERIC_MACHINE

INCLUDE
{
   $UGII_CAM_USER_DEF_EVENT_DIR/ude.cdl
}


FORMATTING
{

 WORD_SEPARATOR     " "
 END_OF_LINE        ""
 SEQUENCE Seq_no    2 2 1 9999

 FORMAT  Seqno      "&__4_00"
 FORMAT  Register   "&_02_00"
 FORMAT  zero       "&_02_00"
 FORMAT  Coordinate "&__5.3_"
 FORMAT  zero_coord "&_01.0_"
 FORMAT  Spindle    "&__5_00"
 FORMAT  zero_spin  "&_01_00"
 FORMAT  Feed       "&__5_00"
 FORMAT  STR        "%s"


 ADDRESS N  {
              FORMAT Seqno
              MAX 9999 Truncate
              MIN 1
              FORCE  off
            }
 ADDRESS G  {
              FORMAT Register
              ZERO_FORMAT zero
              FORCE  off
            }
 ADDRESS motion_g {
              FORMAT Register
              ZERO_FORMAT zero
              LEADER "G"
              FORCE  off
            }
 ADDRESS plane_g {
              FORMAT Register
              ZERO_FORMAT zero
              LEADER "G"
              FORCE  off
            }
 ADDRESS cutcom_g {
              FORMAT Register
              ZERO_FORMAT zero
              LEADER "G"
              FORCE  off
            }
 ADDRESS X  {
              FORMAT Coordinate
              ZERO_FORMAT  zero_coord
              FORCE  off
            }
 ADDRESS Y  {
              FORMAT Coordinate
              ZERO_FORMAT  zero_coord
              FORCE  off
            }
 ADDRESS Z  {
              FORMAT Coordinate
              ZERO_FORMAT  zero_coord
              FORCE  off
            }
 ADDRESS R  {
              FORMAT Coordinate
              ZERO_FORMAT  zero_coord
              FORCE  off
            }
 ADDRESS I  {
              FORMAT Coordinate
              ZERO_FORMAT  zero_coord
              FORCE  off
            }
 ADDRESS J  {
              FORMAT Coordinate
              ZERO_FORMAT  zero_coord
              FORCE  off
            }
 ADDRESS K  {
              FORMAT Coordinate
              ZERO_FORMAT  zero_coord
              FORCE  off
            }
 ADDRESS S  {
              FORMAT Spindle
              ZERO_FORMAT zero_spin
              FORCE  always
            }
 ADDRESS T  {
              FORMAT Register
              ZERO_FORMAT zero
              LEADER "TT"
              FORCE  off
            }
 ADDRESS coolant_m  {
              FORMAT Register
              ZERO_FORMAT zero
              LEADER "M"
              FORCE  off
            }
 ADDRESS spindle_m  {
              FORMAT Register
              ZERO_FORMAT zero
              LEADER "M"
              FORCE  off
            }
 ADDRESS M  {
              FORMAT Register
              ZERO_FORMAT zero
              FORCE  off
            }
 ADDRESS F  {
              FORMAT STR
              FORCE  off
              LEADER ""
            }

###############
# CICLOS
###############
 ADDRESS cycle_g  {
    LEADER "G"
    FORMAT Register
    FORCE  off
    }
 ADDRESS P {
    FORMAT Coordinate
    ZERO_FORMAT zero_coord
    FORCE off
    }
 ADDRESS Q {
    FORMAT Coordinate
    ZERO_FORMAT zero_coord
    FORCE off
    }
 ADDRESS S_tap {
    FORMAT Spindle
    ZERO_FORMAT zero_spin
    FORCE off
    LEADER "M29 S"
 }
 ADDRESS F_ciclo  {
    FORMAT Feed
    FORCE  off
    LEADER "F"
 }


 BLOCK_TEMPLATE Seq_no  { N[$mom_seqnum]  }

 BLOCK_TEMPLATE rapid     {
                          plane_g[$mom_sys_cutcom_plane_code($mom_cutcom_plane)]\opt
                          #motion_g[$mom_sys_rapid_code]
                          "G0*1"
                          X[$mom_pos(0)]
                          Y[$mom_pos(1)]
                          Z[$mom_pos(2)]
                          coolant_m[$mom_sys_coolant_code($mom_coolant_mode)]\opt
                          }

 BLOCK_TEMPLATE rapid_0_0_100     {
                          plane_g[$mom_sys_cutcom_plane_code($mom_cutcom_plane)]\opt
                          #motion_g[$mom_sys_rapid_code]
                          "G0*1"
                          X[0]
                          Y[0]
                          Z[100]
                          spindle_m[$mom_sys_spindle_direction_code($mom_spindle_direction)]
                          coolant_m[$mom_sys_coolant_code($mom_coolant_mode)]\opt
                          }

 BLOCK_TEMPLATE linear    {
                          cutcom_g[$mom_sys_cutcom_code($mom_cutcom_status)]\opt
                          plane_g[$mom_sys_cutcom_plane_code($mom_cutcom_plane)]\opt
                          motion_g[$mom_sys_linear_code]
                          X[$mom_pos(0)]
                          Y[$mom_pos(1)]
                          Z[$mom_pos(2)]
                          coolant_m[$mom_sys_coolant_code($mom_coolant_mode)]\opt
                          F[$parametros_avance]
                          }

 BLOCK_TEMPLATE circle    {
                          cutcom_g[$mom_sys_cutcom_code($mom_cutcom_status)]\opt
                          plane_g[$mom_sys_cutcom_plane_code($mom_cutcom_plane)]\opt
                          motion_g[$mom_sys_circle_code($mom_arc_direction)]
                          X[$mom_pos(0)]
                          Y[$mom_pos(1)]
                          Z[$mom_pos(2)]
                          I[$mom_pos_arc_center(0)]
                          J[$mom_pos_arc_center(1)]
                          K[$mom_pos_arc_center(2)]
                          coolant_m[$mom_sys_coolant_code($mom_coolant_mode)]\opt
                          F[$parametros_avance]
                          }

 BLOCK_TEMPLATE tool_change    { 
                          plane_g[$mom_sys_cutcom_plane_code($mom_cutcom_plane)]\opt
                          "T1"
                          "M6"
                          }

 BLOCK_TEMPLATE tool_change_2  { 
                          plane_g[$mom_sys_cutcom_plane_code($mom_cutcom_plane)]\opt
                          T[$mom_tool_number]
                          "M66"
                          }

 BLOCK_TEMPLATE spindle_start  { 
                          S[$mom_spindle_rpm]
                          spindle_m[$mom_sys_spindle_direction_code($mom_spindle_direction)]
                               }

 BLOCK_TEMPLATE spindle_off    { spindle_m[$mom_sys_spindle_direction_code(OFF)]}

 BLOCK_TEMPLATE coolant_off    { coolant_m[$mom_sys_coolant_code($mom_coolant_mode)] }

 BLOCK_TEMPLATE cutcom_off     { cutcom_g[$mom_sys_cutcom_code(OFF)] }

 BLOCK_TEMPLATE auxiliary      { M[$mom_auxfun] }

 BLOCK_TEMPLATE preparatory    { G[$mom_prefun] }

 BLOCK_TEMPLATE opstop         { M[$mom_sys_optional_stop_code] }

 BLOCK_TEMPLATE stop           { M[$mom_sys_program_stop_code] }

 BLOCK_TEMPLATE end_of_program { M[$mom_sys_end_of_program_code] }

# ***** CICLOS *****

 BLOCK_TEMPLATE cycle_off      { cycle_g[$mom_sys_cycle_off] }

 BLOCK_TEMPLATE cycle_drill  {
   cycle_g[$mom_sys_cycle_drill]
   X[$mom_pos(0)]
   Y[$mom_pos(1)]
   Z[$mom_pos(2) + $mom_cycle_feed_to]
   R[$mom_pos(2) + $mom_cycle_rapid_to]
   F_ciclo[$mom_cycle_feed_rate]
   }

 BLOCK_TEMPLATE cycle_drill_deep  {
   cycle_g[$mom_sys_cycle_drill_deep]
   X[$mom_pos(0)]
   Y[$mom_pos(1)]
   Z[$mom_pos(2) + $mom_cycle_feed_to]
   R[$mom_pos(2) + $mom_cycle_rapid_to]
   Q[$mom_cycle_step1]
   F_ciclo[$mom_cycle_feed_rate]
   }

 BLOCK_TEMPLATE spindle_tap { S_tap[$mom_spindle_rpm] }

 BLOCK_TEMPLATE cycle_tap  {
   cycle_g[$mom_sys_cycle_tap($mom_spindle_direction)]
   X[$mom_pos(0)]
   Y[$mom_pos(1)]
   Z[$mom_pos(2) + $mom_cycle_feed_to]
   R[$mom_pos(2) + $mom_cycle_rapid_to]
   F_ciclo[$mom_cycle_feed_rate]
   }

}
